{% extends "base.html" %}
{% block content %}

{% if livro %}
  <h3>Editar livro #{{ livro.id }}</h3>
  <form method="post" action="{{ url_for('editar_livro', livro_id=livro.id) }}" class="d-inline">
{% else %}
  <h3>Cadastrar novo livro</h3>
  <form method="post" action="{{ url_for('novo_livro') }}" class="d-inline">
{% endif %}

  {% if not livro %}
    <label>ID (manual) *</label>
    <input type="number" name="id" class="form-control mb-2" required>
  {% else %}
    <p><strong>ID:</strong> {{ livro.id }}</p>
  {% endif %}

  <label>Título *</label>
  <input type="text" name="titulo"
         value="{{ livro.titulo if livro else '' }}"
         class="form-control mb-2" required>

  <label>Autor</label>
  <input type="text" name="autor"
         value="{{ livro.autor if livro else '' }}"
         class="form-control mb-2">

  <label>Editora</label>
  <input type="text" name="editora"
         value="{{ livro.editora if livro else '' }}"
         class="form-control mb-2">

  <label>Prateleira</label>
  <input type="text" name="prateleira"
         value="{{ livro.prateleira if livro else '' }}"
         class="form-control mb-2"
         placeholder="Ex.: A3, Estante 2, Infantil, etc.">

  <label>Observação (opcional)</label>
  <textarea name="observacao" class="form-control mb-2"
            placeholder="Ex.: capa rasgada, edição antiga, livro muito procurado...">{{ livro.observacao if livro else '' }}</textarea>

  <label>Ano</label>
  <input type="number" name="ano"
         value="{{ livro.ano if livro and livro.ano else '' }}"
         class="form-control mb-2">

  <label>ISBN</label>
  <input type="text" name="isbn"
         value="{{ livro.isbn if livro else '' }}"
         class="form-control mb-2">

  {% if livro %}
    <label>Quantidade total</label>
    <input type="number" name="quantidade_total"
           value="{{ livro.quantidade_total }}"
           class="form-control mb-2">

    <label>Quantidade disponível</label>
    <input type="number" name="quantidade_disponivel"
           value="{{ livro.quantidade_disponivel }}"
           class="form-control mb-3">
  {% else %}
    <label>Quantidade (exemplares) *</label>
    <input type="number" name="quantidade" min="1"
           class="form-control mb-3" required>
  {% endif %}

  <button type="submit" class="btn btn-primary">Salvar</button>
  <a href="{{ url_for('listar_livros') }}" class="btn btn-secondary">Cancelar</a>
</form>

{% if livro %}
<form method="post"
      action="{{ url_for('excluir_livro', livro_id=livro.id) }}"
      class="d-inline"
      onsubmit="return confirm('Tem certeza que deseja excluir este livro?');">
  <button type="submit" class="btn btn-danger">Excluir livro</button>
</form>
{% endif %}

{% endblock %}
